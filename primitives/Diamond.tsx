import { getContract, readContract } from "thirdweb";
import { base, baseSepolia } from "thirdweb/chains";
// Import the thirdweb client from your server-side utility
import { getThirdwebClient } from '../src/utils/createThirdwebClient';

// Initialize the client from the server-side utility
const client = getThirdwebClient();

// Determine if we are in testnet mode (flag persisted by the UI switch)
const isTestnet = (() => {
  if (typeof window !== "undefined") {
    return localStorage.getItem("useTestnet") === "true";
  }
  // Server-side rendering defaults to mainnet
  return false;
})();

export const diamondAddress = (() => {
  const address = isTestnet ? process.env.DIAMOND_ADDRESS_TESTNET : process.env.DIAMOND_ADDRESS;
  if (!address) {
    throw new Error(`$${isTestnet ? 'DIAMOND_ADDRESS_TESTNET' : 'DIAMOND_ADDRESS'} environment variable is not set.`);
  }
  return address;
})();

// Get contract details
const contract = getContract({
  client,
  chain: isTestnet ? baseSepolia : base,
  address: diamondAddress, // Diamond contract address
  abi: [{"inputs":[{"internalType":"address","name":"_utilityCoDiamond","type":"address"}],"stateMutability":"payable","type":"constructor"},{"inputs":[],"name":"DiamondWritable__InvalidInitializationParameters","type":"error"},{"inputs":[],"name":"DiamondWritable__RemoveTargetNotZeroAddress","type":"error"},{"inputs":[],"name":"DiamondWritable__ReplaceTargetIsIdentical","type":"error"},{"inputs":[],"name":"DiamondWritable__SelectorAlreadyAdded","type":"error"},{"inputs":[],"name":"DiamondWritable__SelectorIsImmutable","type":"error"},{"inputs":[],"name":"DiamondWritable__SelectorNotFound","type":"error"},{"inputs":[],"name":"DiamondWritable__SelectorNotSpecified","type":"error"},{"inputs":[],"name":"DiamondWritable__TargetHasNoCode","type":"error"},{"inputs":[],"name":"ERC165Base__InvalidInterfaceId","type":"error"},{"inputs":[],"name":"Ownable__NotOwner","type":"error"},{"inputs":[],"name":"Ownable__NotTransitiveOwner","type":"error"},{"inputs":[],"name":"Proxy__ImplementationIsNotContract","type":"error"},{"inputs":[],"name":"SafeOwnable__NotNomineeOwner","type":"error"},{"anonymous":false,"inputs":[{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"enum IERC2535DiamondCutInternal.FacetCutAction","name":"action","type":"uint8"},{"internalType":"bytes4[]","name":"selectors","type":"bytes4[]"}],"indexed":false,"internalType":"struct IERC2535DiamondCutInternal.FacetCut[]","name":"facetCuts","type":"tuple[]"},{"indexed":false,"internalType":"address","name":"target","type":"address"},{"indexed":false,"internalType":"bytes","name":"data","type":"bytes"}],"name":"DiamondCut","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"stateMutability":"payable","type":"fallback"},{"inputs":[],"name":"acceptOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"enum IERC2535DiamondCutInternal.FacetCutAction","name":"action","type":"uint8"},{"internalType":"bytes4[]","name":"selectors","type":"bytes4[]"}],"internalType":"struct IERC2535DiamondCutInternal.FacetCut[]","name":"facetCuts","type":"tuple[]"},{"internalType":"address","name":"target","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"diamondCut","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"selector","type":"bytes4"}],"name":"facetAddress","outputs":[{"internalType":"address","name":"facet","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"facetAddresses","outputs":[{"internalType":"address[]","name":"addresses","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"facet","type":"address"}],"name":"facetFunctionSelectors","outputs":[{"internalType":"bytes4[]","name":"selectors","type":"bytes4[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"facets","outputs":[{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bytes4[]","name":"selectors","type":"bytes4[]"}],"internalType":"struct IERC2535DiamondLoupeInternal.Facet[]","name":"diamondFacets","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getFallbackAddress","outputs":[{"internalType":"address","name":"fallbackAddress","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"nomineeOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"fallbackAddress","type":"address"}],"name":"setFallbackAddress","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"committeeId","type":"uint256"},{"indexed":false,"internalType":"string","name":"name","type":"string"},{"indexed":false,"internalType":"address","name":"creator","type":"address"}],"name":"CommitteeCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"committeeId","type":"uint256"},{"indexed":false,"internalType":"address","name":"member","type":"address"}],"name":"CommitteeMemberRemoved","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"role","type":"string"},{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":false,"internalType":"string","name":"name","type":"string"}],"name":"RoleGranted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"role","type":"string"},{"indexed":true,"internalType":"address","name":"account","type":"address"}],"name":"RoleRevoked","type":"event"},{"inputs":[],"name":"ARCHITECT","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"HIGH_TABLE","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MEMBER","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ORACLE","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SCHOLAR","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SENTINEL","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"VANGUARD","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"foundingStatement","type":"string"},{"internalType":"string","name":"principles","type":"string"}],"name":"createCommittee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getAllCommittees","outputs":[{"internalType":"uint256[]","name":"ids","type":"uint256[]"},{"internalType":"string[]","name":"names","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCommitteeCount","outputs":[{"internalType":"uint256","name":"count","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"committeeId","type":"uint256"}],"name":"getCommitteeDetails","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"foundingStatement","type":"string"},{"internalType":"string","name":"principles","type":"string"},{"internalType":"address","name":"founder","type":"address"},{"internalType":"uint256","name":"memberCount","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"committeeName","type":"string"}],"name":"getCommitteeIdByName","outputs":[{"internalType":"uint256","name":"committeeId","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"committeeId","type":"uint256"}],"name":"getCommitteeMembers","outputs":[{"internalType":"address[]","name":"members","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"role","type":"string"},{"internalType":"address","name":"account","type":"address"},{"internalType":"string","name":"name","type":"string"}],"name":"grantRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"role","type":"string"},{"internalType":"address","name":"account","type":"address"}],"name":"hasRole","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"initializeDirectory","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"committeeName","type":"string"},{"internalType":"address","name":"account","type":"address"}],"name":"isCommitteeMember","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"committeeId","type":"uint256"}],"name":"joinCommittee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"committeeId","type":"uint256"},{"internalType":"address","name":"member","type":"address"}],"name":"removeCommitteeMember","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"role","type":"string"},{"internalType":"address","name":"account","type":"address"}],"name":"revokeRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getAllRoles","outputs":[{"internalType":"string[]","name":"roles","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"proposalId","type":"uint256"},{"internalType":"string","name":"committeeName","type":"string"}],"name":"getCommitteeApproval","outputs":[{"internalType":"bool","name":"approved","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"dioId","type":"uint256"}],"name":"getDIOInfo","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"stakedTokenCount","type":"uint256"},{"internalType":"uint256[]","name":"stakedTokens","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getDIOMarkers","outputs":[{"internalType":"uint256[]","name":"dioIds","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"role","type":"string"},{"internalType":"address","name":"member","type":"address"}],"name":"getMemberName","outputs":[{"internalType":"string","name":"memberName","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getNextProposalId","outputs":[{"internalType":"uint256","name":"nextId","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getNextVRDIId","outputs":[{"internalType":"uint256","name":"nextId","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"getOwnedTokens","outputs":[{"internalType":"uint256[]","name":"tokenIds","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"proposalId","type":"uint256"}],"name":"getProposalDetails","outputs":[{"internalType":"address","name":"submitter","type":"address"},{"internalType":"string","name":"documentLink","type":"string"},{"internalType":"string[]","name":"assignedCommittees","type":"string[]"},{"internalType":"bool","name":"highTableApproved","type":"bool"},{"internalType":"bool","name":"highTableVetoed","type":"bool"},{"internalType":"uint256","name":"dioId","type":"uint256"},{"components":[{"internalType":"uint256","name":"principalAmount","type":"uint256"},{"internalType":"uint256","name":"interestRate","type":"uint256"},{"internalType":"uint256","name":"amortizationDuration","type":"uint256"},{"internalType":"uint256","name":"deferralPeriod","type":"uint256"},{"internalType":"string","name":"perpetualReturns","type":"string"},{"internalType":"address","name":"debtor","type":"address"}],"internalType":"struct RENSNCEDAOSTRG.DIOParams","name":"dioParams","type":"tuple"},{"internalType":"uint256","name":"totalMKVLI20","type":"uint256"},{"internalType":"bool","name":"highTableOverride","type":"bool"},{"internalType":"string","name":"highTableJustification","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"role","type":"string"}],"name":"getRoleAdmin","outputs":[{"internalType":"string","name":"adminRole","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"role","type":"string"}],"name":"getRoleMembers","outputs":[{"internalType":"address[]","name":"members","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getStakedDIO","outputs":[{"internalType":"uint256","name":"dioId","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"dioId","type":"uint256"}],"name":"getStakedTokensForDIO","outputs":[{"internalType":"uint256[]","name":"tokenIds","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"address","name":"holder","type":"address"}],"name":"getStakingRecords","outputs":[{"internalType":"uint256[][]","name":"tokenIdRecords","type":"uint256[][]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"getTokenBalance","outputs":[{"internalType":"uint256","name":"balance","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTokenMetadata","outputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"symbol","type":"string"},{"internalType":"uint8","name":"decimals","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalSupply","outputs":[{"internalType":"uint256","name":"totalSupply","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getUSDCReserve","outputs":[{"internalType":"uint256","name":"reserve","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"getVRDIDetails","outputs":[{"components":[{"internalType":"uint256","name":"dioId","type":"uint256"},{"internalType":"uint256","name":"principalUSDC","type":"uint256"},{"internalType":"uint256","name":"principalMKVLI20","type":"uint256"},{"internalType":"uint256","name":"interestRate","type":"uint256"},{"internalType":"uint256","name":"totalRepaymentAmount","type":"uint256"},{"internalType":"address","name":"debtor","type":"address"},{"internalType":"bool","name":"isFrozen","type":"bool"},{"internalType":"bool","name":"isClosed","type":"bool"},{"internalType":"uint256","name":"depositedUSDC","type":"uint256"},{"internalType":"uint256","name":"startTimestamp","type":"uint256"},{"internalType":"uint256","name":"amortizationDuration","type":"uint256"},{"internalType":"uint256","name":"deferralPeriod","type":"uint256"},{"internalType":"uint256","name":"activePhaseIndex","type":"uint256"}],"internalType":"struct RENSNCERPSTRY.VRDIDetails","name":"details","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"uint256","name":"phaseIndex","type":"uint256"}],"name":"getVRDIPhaseAllCommitteeApprovals","outputs":[{"components":[{"internalType":"string","name":"committeeName","type":"string"},{"internalType":"bool","name":"isApproved","type":"bool"}],"internalType":"struct RENSNCERPSTRY.PhaseCommitteeApprovalStatus[]","name":"statuses","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"uint256","name":"phaseIndex","type":"uint256"},{"internalType":"string","name":"committeeName","type":"string"}],"name":"getVRDIPhaseCommitteeApproval","outputs":[{"internalType":"bool","name":"approved","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"getVRDIPhases","outputs":[{"internalType":"uint256[]","name":"phaseAmountsUSDC","type":"uint256[]"},{"internalType":"bool[]","name":"isActive","type":"bool[]"},{"internalType":"bool[]","name":"isComplete","type":"bool[]"},{"internalType":"string[]","name":"evidenceLinks","type":"string[]"},{"internalType":"uint256[]","name":"withdrawnAmountsUSDC","type":"uint256[]"},{"internalType":"uint256[]","name":"completionTimestamps","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"isTokenStaked","outputs":[{"internalType":"bool","name":"staked","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"owner","type":"address"}],"stateMutability":"view","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"proposalId","type":"uint256"},{"indexed":false,"internalType":"string","name":"committeeName","type":"string"}],"name":"CommitteeApproved","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"proposalId","type":"uint256"},{"indexed":false,"internalType":"string","name":"committeeName","type":"string"}],"name":"CommitteeAssigned","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"proposalId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"dioId","type":"uint256"},{"indexed":false,"internalType":"address[]","name":"holders","type":"address[]"},{"indexed":false,"internalType":"uint256[]","name":"amounts","type":"uint256[]"}],"name":"DIOInitialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"proposalId","type":"uint256"},{"indexed":false,"internalType":"string","name":"committeeNameChecked","type":"string"},{"indexed":false,"internalType":"bool","name":"isApproved","type":"bool"},{"indexed":false,"internalType":"uint256","name":"assignedCommitteesLength","type":"uint256"}],"name":"DebugCheckCommitteeApproval","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"proposalId","type":"uint256"},{"indexed":false,"internalType":"string","name":"justification","type":"string"}],"name":"HighTableOverride","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"proposalId","type":"uint256"},{"indexed":false,"internalType":"address","name":"submitter","type":"address"},{"indexed":false,"internalType":"string","name":"documentLink","type":"string"}],"name":"ProposalSubmitted","type":"event"},{"inputs":[{"internalType":"uint256","name":"proposalId","type":"uint256"},{"internalType":"string","name":"committeeName","type":"string"}],"name":"approveProposal","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"proposalId","type":"uint256"},{"internalType":"string","name":"committeeName","type":"string"}],"name":"assignCommittee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"proposalId","type":"uint256"},{"components":[{"internalType":"uint256","name":"principalAmount","type":"uint256"},{"internalType":"uint256","name":"interestRate","type":"uint256"},{"internalType":"uint256","name":"amortizationDuration","type":"uint256"},{"internalType":"uint256","name":"deferralPeriod","type":"uint256"},{"internalType":"string","name":"perpetualReturns","type":"string"},{"internalType":"address","name":"debtor","type":"address"}],"internalType":"struct RENSNCEDAOSTRG.DIOParams","name":"params","type":"tuple"},{"internalType":"address[]","name":"holders","type":"address[]"},{"internalType":"uint256[]","name":"amounts","type":"uint256[]"}],"name":"finalizeProposal","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"proposalId","type":"uint256"},{"internalType":"string","name":"justification","type":"string"}],"name":"overrideCommitteeApproval","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"documentLink","type":"string"}],"name":"submitProposal","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"proposalId","type":"uint256"},{"internalType":"bool","name":"veto","type":"bool"}],"name":"vetoProposal","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"ECDSA__InvalidS","type":"error"},{"inputs":[],"name":"ECDSA__InvalidSignature","type":"error"},{"inputs":[],"name":"ECDSA__InvalidV","type":"error"},{"inputs":[],"name":"ERC20Base__ApproveFromZeroAddress","type":"error"},{"inputs":[],"name":"ERC20Base__ApproveToZeroAddress","type":"error"},{"inputs":[],"name":"ERC20Base__BurnExceedsBalance","type":"error"},{"inputs":[],"name":"ERC20Base__BurnFromZeroAddress","type":"error"},{"inputs":[],"name":"ERC20Base__InsufficientAllowance","type":"error"},{"inputs":[],"name":"ERC20Base__MintToZeroAddress","type":"error"},{"inputs":[],"name":"ERC20Base__TransferExceedsBalance","type":"error"},{"inputs":[],"name":"ERC20Base__TransferFromZeroAddress","type":"error"},{"inputs":[],"name":"ERC20Base__TransferToZeroAddress","type":"error"},{"inputs":[],"name":"ERC20Extended__ExcessiveAllowance","type":"error"},{"inputs":[],"name":"ERC20Extended__InsufficientAllowance","type":"error"},{"inputs":[],"name":"ERC20Permit__ExpiredDeadline","type":"error"},{"inputs":[],"name":"ERC20Permit__InvalidSignature","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"count","type":"uint256"}],"name":"DebugFoundRedeemableToken","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"length","type":"uint256"}],"name":"DebugReserveTokensCheck","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"name","type":"string"},{"indexed":false,"internalType":"string","name":"symbol","type":"string"},{"indexed":false,"internalType":"uint8","name":"decimals","type":"uint8"}],"name":"MetadataInitialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"nextTokenId","type":"uint256"}],"name":"TokenIdInitialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[],"name":"DOMAIN_SEPARATOR","outputs":[{"internalType":"bytes32","name":"domainSeparator","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MAX_SUPPLY","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MIN_MINT_PRICE","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"holder","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getTokenOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"name_","type":"string"},{"internalType":"string","name":"symbol_","type":"string"}],"name":"initializeMKVLI20","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"nonces","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"name":"permit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"holder","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"redeemer","type":"address"},{"indexed":false,"internalType":"uint256","name":"balance","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"DebugBalanceCheck","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"from","type":"address"},{"indexed":false,"internalType":"uint256","name":"fromBalance","type":"uint256"},{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"toBalance","type":"uint256"}],"name":"DebugBalanceUpdate","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"count","type":"uint256"}],"name":"DebugFoundRedeemableToken","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"totalSupply","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"mkvliInReserve","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"mkvliBurned","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"mkvliCirculatingSupply","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"actualUsdcInContract","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"usdcDeployedInVRDIs","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"effectiveUsdcReserve","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"redemptionPrice","type":"uint256"}],"name":"DebugRedemptionComponents","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"tokenCount","type":"uint256"}],"name":"DebugTokenOwnershipCheck","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"phaseIndex","type":"uint256"}],"name":"PhaseActivated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"phaseIndex","type":"uint256"},{"indexed":false,"internalType":"string","name":"committee","type":"string"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"PhaseApprovalUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"phaseIndex","type":"uint256"},{"indexed":false,"internalType":"string","name":"evidenceLink","type":"string"}],"name":"PhaseCompleted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"usdcValue","type":"uint256"}],"name":"TokensRedeemed","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"},{"indexed":true,"internalType":"address","name":"holder","type":"address"},{"indexed":false,"internalType":"uint256[]","name":"tokenIds","type":"uint256[]"}],"name":"TokensStakedForVRDI","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"},{"indexed":false,"internalType":"bool","name":"withinTimeline","type":"bool"}],"name":"VRDIClosed","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"dioId","type":"uint256"},{"indexed":false,"internalType":"address","name":"debtor","type":"address"},{"indexed":false,"internalType":"uint256","name":"totalRepaymentAmount","type":"uint256"}],"name":"VRDICreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"VRDIFrozen","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amountUSDC","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"depositedUSDC","type":"uint256"}],"name":"VRDIPaymentDeposited","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"VRDIUnfrozen","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"vrId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"phaseIndex","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amountUSDC","type":"uint256"}],"name":"VRDIWithdrawal","type":"event"},{"inputs":[],"name":"BURN_WALLET","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"activateNextPhase","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"uint256","name":"phaseIndex","type":"uint256"},{"internalType":"string","name":"committeeName","type":"string"}],"name":"approvePhaseCompletion","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"calculateRedemptionPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"closeVRDI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"uint256","name":"amountUSDC","type":"uint256"}],"name":"depositVRDIPayment","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"freezeVRDI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"uint256","name":"phaseIndex","type":"uint256"}],"name":"getPhaseStatus","outputs":[{"internalType":"uint256","name":"remainingAmountUSDC","type":"uint256"},{"internalType":"uint256","name":"withdrawnUSDC","type":"uint256"},{"internalType":"uint256","name":"completionTimestamp","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"getTimeRemaining","outputs":[{"internalType":"uint256","name":"timeRemaining","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"getVRDIBalance","outputs":[{"internalType":"uint256","name":"totalWithdrawnUSDC","type":"uint256"},{"internalType":"uint256","name":"depositedUSDCValue","type":"uint256"},{"internalType":"uint256","name":"remainingDebtUSDC","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_usdcTokenAddress","type":"address"}],"name":"initializeReserveService","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"dioId","type":"uint256"},{"internalType":"uint256","name":"principalUSDC","type":"uint256"},{"internalType":"uint256","name":"principalMKVLI20","type":"uint256"},{"internalType":"uint256","name":"interestRate","type":"uint256"},{"internalType":"uint256","name":"amortizationDuration","type":"uint256"},{"internalType":"uint256","name":"deferralPeriod","type":"uint256"},{"internalType":"address","name":"debtor","type":"address"},{"internalType":"uint256[]","name":"phaseAmountsUSDC","type":"uint256[]"}],"name":"initializeVRDI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"redeemTokens","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"address[]","name":"holders","type":"address[]"},{"internalType":"uint256[]","name":"amountsToStake","type":"uint256[]"}],"name":"stakeForVRDI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"uint256","name":"phaseIndex","type":"uint256"},{"internalType":"string","name":"evidenceLink","type":"string"}],"name":"submitPhaseCompletion","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"}],"name":"unfreezeVRDI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"vrId","type":"uint256"},{"internalType":"uint256","name":"amountUSDC","type":"uint256"}],"name":"withdrawVRDIFunds","outputs":[],"stateMutability":"nonpayable","type":"function"}],
});

// Function to get all facets and their selectors
async function getFacets() {
    try {
      // Call the 'facets' method on the contract
      const facetsResponse = await readContract({
        contract: contract,
        method: "facets", // This method returns all facets and their selectors
      });
      console.log(facetsResponse);
  
      return facetsResponse;
    } catch (error: any) {
      const msg = typeof error?.message === 'string' ? error.message : '';
      if (!msg.includes('decode zero data')) {
      console.error("Error fetching facets:", error);
      }
      return [];
    }
}
  
  // Function to get details for a specific method (function selector) in a facet
async function getMethodDetails(facetAddress: `0x${string}`, selector: `0x${string}`) {
    try {
      // Call the 'facetFunctionSelectors' method to get the function selectors for a given facet address
      const selectors = await readContract({
        contract: contract,
        method: "facetFunctionSelectors",
        params: [facetAddress],
      });
      console.log(selectors)
  
      // Find and return the selector details (if applicable)
      const methodDetails = selectors.find((sel: any) => sel === selector);
      return methodDetails ? methodDetails : null;
    } catch (error) {
      console.error("Error fetching method details:", error);
      return null;
    }
}
  
export { getFacets };
export { getMethodDetails };
export { contract };